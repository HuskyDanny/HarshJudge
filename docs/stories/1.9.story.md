# Story 1.9: Implement `getStatus` MCP Tool

## Status

Done

## Story

**As a** Claude Code user,
**I want** to query the status of scenarios and runs,
**so that** I can see what tests exist and their current state.

## Acceptance Criteria

1. `getStatus` tool registered in MCP server
2. When called without parameters, returns project-level status
3. When called with `scenarioSlug`, returns scenario detail
4. Returns appropriate error if project not initialized
5. Returns appropriate error if scenario not found
6. Performance: responds in < 1 second for 100+ scenarios
7. Unit tests verify both query modes

## Tasks / Subtasks

- [x] **Task 1: Implement getStatus handler**
- [x] **Task 2: Update mcp-server exports**
- [x] **Task 3: Write unit tests**
- [x] **Task 4: Verify build and tests pass**

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-04 | 1.0 | Initial story | SM Agent (Bob) |

---

## Dev Agent Record

**Implementation Date:** 2025-12-04

**Files Created/Modified:**
- `packages/mcp-server/src/handlers/get-status.ts` (NEW) - Handler implementation
- `packages/mcp-server/tests/handlers/get-status.test.ts` (NEW) - 13 unit tests
- `packages/shared/src/schemas/mcp-schemas.ts` (MODIFIED) - Added GetStatusParamsSchema
- `packages/shared/src/types/mcp-types.ts` (MODIFIED) - Added ProjectStatus, ScenarioSummary, ScenarioDetail, ScenarioMeta, RunSummary types

**Implementation Details:**
- Project-level status: Returns projectName, scenarioCount, passing/failing/neverRun counts, and list of ScenarioSummary
- Scenario-level status: Returns slug, title, tags, content (without frontmatter), meta statistics, and recentRuns (last 10)
- Parses YAML frontmatter from scenario.md files
- Calculates pass rate as percentage
- Handles scenarios without meta.yaml gracefully
- Sorts recent runs by completedAt descending

**Test Coverage:** 13 tests covering project status, scenario detail, pass rate calculation, recent runs ordering, and error handling

---

## QA Results

**QA Date:** 2025-12-04
**Status:** PASSED

- All 13 unit tests pass
- TypeScript compilation successful
- ESLint validation passed
- All acceptance criteria met
